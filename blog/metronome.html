<!doctype html>
<html lang="en">

<head>
    <title> Just a Fucking Metronome: an N-byte metronome app </title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/pygments.css">
    
<link rel="stylesheet" href="/static/css/blog.css">
<meta property="description" content="An ad-free, no-bullshit, human-friendly metronome web app.">

    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicon-16x16.png">
    
</head>
<body>
    <header>
        <div data-nosnippet>
        <nav>
        <a href="/index.html" class="navlink">home</a>
        | <a href="/blog.html" class="navlink">blog</a>
        | <a href="/software.html" class="navlink">software</a>
        | <a href="/feed.xml"><img class="navbar-img" src="/static/img/rss.png"></a>
        | <a href="https://twitter.com/KevinGalligan2"><img class="navbar-img" src="/static/img/twitter.png"></a>
        </nav>
        </div>
    </header>

<h2>Just a Fucking Metronome: an N-byte metronome app</h2>
<p>You might have heard already, but we're in the middle of a pandemic.</p>
<p>A <a href="https://idlewords.com/talks/website_obesity.htm">website obesity pandemic</a>.</p>
<p>The weight of the average website in 2017 was 3MB <a href="https://discuss.httparchive.org/t/tracking-page-weight-over-time/1049/2">[1]</a>. That's 3.5 times the size of a copy of The Brothers Karamazov <a href="http://www.gutenberg.org/ebooks/28054">[2]</a>. Often, less than 1% of the weight is actual content. Most of the weight comes from ads and uncompressed, <a href="https://tafttest.com/">Taft test</a>-failing images. This gets worse every year, making the web slower and less accessible for everyone.</p>
<p>Recently, with this glum state of affairs on the back of my mind, I was searching for a metronome web app. A metronome, by the way, is a tool that emits sound at fixed intervals, allowing you to practice playing music to a regular beat. I didn't like any of them. Either they were extremely overweight (as large as 11.35MB), or they were mobile-unfriendly (it's annoying to set numeric values precisely using a slider, like the "beats per minute" (BPM) of a metronome), or they were full of trackers (hi Google and Facebook!).</p>
<p>And so, I decided to make my own. Mobile-friendliness would be essential. I also wanted to design the interface without sliders, because <em>fuck sliders</em>. Finally, to add spice to the task, I wanted to make the app less than 1KB in size. The smallest metronome app I found was 217KB, but since people make <a href="https://js1k.com/">1KB JavaScript games for fun</a>, I was confident that this would be possible.</p>
<h3>Human-readable version (N KB)</h3>
<p>The final app can be found <a href="/apps/metronome.html">here</a>. I'll first present the human-readable version, which is quite a bit larger than the minified version.</p>
<p>The HTML is simple, consisting of just a play button and a few buttons to change the BPM of the metronome. It weighs in at 777 bytes.</p>
<div class="codehilite"><pre><span></span><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Just a F*cking Metronome<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/static/apps/metronome/m.css&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;/static/apps/metronome/a.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;bpm&quot;</span><span class="p">&gt;</span>100 bpm<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;change&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;play&quot;</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;change();&quot;</span><span class="p">&gt;</span>play<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(-1);&quot;</span><span class="p">&gt;</span>-1<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(1);&quot;</span><span class="p">&gt;</span>+1<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(-5);&quot;</span><span class="p">&gt;</span>-5<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(5);&quot;</span><span class="p">&gt;</span>+5<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(-25);&quot;</span><span class="p">&gt;</span>-25<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">button</span> <span class="na">onclick</span><span class="o">=</span><span class="s">&quot;adjustBpm(25);&quot;</span><span class="p">&gt;</span>+25<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>Just a F*cking Metronome | <span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/&quot;</span><span class="p">&gt;</span>kevingal.com<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>


<p>The CSS is similarly light-weight, at 266 bytes. It includes some luxurious styling options, like colouring the play button red or green.</p>
<div class="codehilite"><pre><span></span><span class="nt">div</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="k">grid</span><span class="p">;</span>
    <span class="k">grid-template-columns</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
    <span class="k">max-width</span><span class="p">:</span> <span class="mi">150</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">#</span><span class="nn">bpm</span> <span class="p">{</span>
    <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">line-height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">play</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="mh">#4CAF50</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">.</span><span class="nc">stop</span> <span class="p">{</span>
    <span class="k">background-color</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">button</span> <span class="p">{</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>Finally, the JavaScript, which weighs in at a chunky 1573 bytes. In the main thread, when the user starts the metronome, it kicks off a scheduling function that runs every 25 milliseconds. The scheduling function calls the WebAudio interface to scheule any beeps that are due to play in the next 100 milliseconds. WebAudio then plays the beeps in a separate thread. If we played the audio directly in the main thread (which is what I tried before reading <a href="https://www.html5rocks.com/en/tutorials/audio/scheduling/">this excellent article</a>), then there would be unacceptable delays in sound whenever we lost control to the browser's UI and book-keeping functions.</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">play</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">bpm</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">interval</span> <span class="o">=</span> <span class="mf">0.025</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">lookahead</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">nextNoteTime</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">audioContext</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AudioContext</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">run</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">play</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">schedule</span><span class="p">();</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">run</span><span class="p">,</span> <span class="nx">interval</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">schedule</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">nextNoteTime</span> <span class="o">&lt;</span> <span class="nx">audioContext</span><span class="p">.</span><span class="nx">currentTime</span> <span class="o">+</span> <span class="nx">lookahead</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">scheduleNote</span><span class="p">(</span><span class="nx">nextNoteTime</span><span class="p">);</span>
        <span class="nx">nextNoteTime</span> <span class="o">=</span> <span class="nx">calculateNextNoteTime</span><span class="p">(</span><span class="nx">nextNoteTime</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">scheduleNote</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">osc</span> <span class="o">=</span> <span class="nx">audioContext</span><span class="p">.</span><span class="nx">createOscillator</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">vol</span> <span class="o">=</span> <span class="nx">audioContext</span><span class="p">.</span><span class="nx">createGain</span><span class="p">();</span>
    <span class="nx">osc</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">vol</span><span class="p">);</span>
    <span class="nx">vol</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">audioContext</span><span class="p">.</span><span class="nx">destination</span><span class="p">);</span>
    <span class="nx">osc</span><span class="p">.</span><span class="nx">frequency</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
    <span class="nx">osc</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
    <span class="nx">osc</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">t</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">);</span>
    <span class="nx">vol</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">setValueAtTime</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
    <span class="nx">vol</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">exponentialRampToValueAtTime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">t</span><span class="p">,</span> <span class="nx">t</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">);</span>
    <span class="nx">vol</span><span class="p">.</span><span class="nx">gain</span><span class="p">.</span><span class="nx">linearRampToValueAtTime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">t</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">calculateNextNoteTime</span><span class="p">(</span><span class="nx">previousNoteTime</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">previousNoteTime</span> <span class="o">+</span> <span class="mi">60</span><span class="o">/</span><span class="nx">bpm</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">change</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">play</span> <span class="o">=</span> <span class="o">!</span><span class="nx">play</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">play</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">updatePlayButton</span><span class="p">(</span><span class="s2">&quot;stop&quot;</span><span class="p">);</span>
        <span class="nx">nextNoteTime</span> <span class="o">=</span> <span class="nx">audioContext</span><span class="p">.</span><span class="nx">currentTime</span><span class="p">;</span>
        <span class="nx">run</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">updatePlayButton</span><span class="p">(</span><span class="s2">&quot;play&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">g</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">id</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">updatePlayButton</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">g</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
    <span class="nx">g</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">).</span><span class="nx">className</span> <span class="o">=</span> <span class="nx">s</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">adjustBpm</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">bpm</span><span class="o">+</span><span class="nx">d</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="o">||</span> <span class="nx">bpm</span><span class="o">+</span><span class="nx">d</span> <span class="o">&gt;</span> <span class="mi">240</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">g</span><span class="p">(</span><span class="s2">&quot;bpm&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">g</span><span class="p">(</span><span class="s2">&quot;bpm&quot;</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">200</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">bpm</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="nx">bpm</span><span class="o">+</span><span class="nx">d</span><span class="p">),</span> <span class="mi">240</span><span class="p">);</span>
    <span class="nx">g</span><span class="p">(</span><span class="s2">&quot;bpm&quot;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">bpm</span> <span class="o">+</span> <span class="s2">&quot; bpm&quot;</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h3>Minified version (976 bytes)</h3>
<p>To shrink the waistline of the website below the target 1KB, I employed a few strategies:</p>
<ul>
<li>Removing unnecessary HTML. Described <a href="https://blog.notryan.com/013.txt">here</a>, for example. Highlights: tag attributes not needing quotes if the attribute value doesn't contain spaces, making <code>&lt;p id=x&gt;</code> the same as <code>&lt;p id="x"&gt;</code>; and being able to omit \&lt;html>, \&lt;head> and \&lt;body> tags.</li>
<li>Making IDs, variable names, function names etc. as small as possible.</li>
</ul>
<p>After going through all that, I was left with a 1-line, 976-byte file. It was more space efficient to include the CSS and JavaScript inline. Other dirty tricks worth mentioning: using JS to generate the buttons...what else? Removed unnecessary stuff. Extravagant use of colour.</p>
<p>How to make the 1-liner wrap?</p>
<div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span><span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Metronome âŒ›<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">viewport</span> <span class="na">content</span><span class="o">=</span><span class="s">width=device-width</span><span class="p">&gt;&lt;</span><span class="nt">style</span><span class="p">&gt;</span><span class="nt">body</span><span class="p">{</span><span class="k">display</span><span class="p">:</span><span class="k">grid</span><span class="p">;</span><span class="k">grid-template-columns</span><span class="p">:</span><span class="mi">50</span><span class="kt">%</span><span class="mi">50</span><span class="kt">%</span><span class="p">;</span><span class="k">max-width</span><span class="p">:</span><span class="mi">150</span><span class="kt">px</span><span class="p">}#</span><span class="nn">b</span><span class="o">,</span><span class="nt">button</span><span class="p">{</span><span class="k">text-align</span><span class="p">:</span><span class="kc">center</span><span class="p">;</span><span class="k">line-height</span><span class="p">:</span><span class="mi">50</span><span class="kt">px</span><span class="p">}&lt;/</span><span class="nt">style</span><span class="p">&gt;&lt;</span><span class="nt">script</span><span class="p">&gt;</span><span class="nx">p</span><span class="o">=!</span><span class="mi">1</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="nx">i</span><span class="o">=</span><span class="mf">.025</span><span class="p">,</span><span class="nx">l</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span><span class="nx">n</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="nx">M</span><span class="o">=</span><span class="nb">Math</span><span class="p">,</span><span class="nx">D</span><span class="o">=</span><span class="nb">document</span><span class="p">,</span><span class="nx">x</span><span class="o">=</span><span class="k">new</span> <span class="nx">AudioContext</span><span class="p">,</span><span class="nx">H</span><span class="o">=</span><span class="p">((</span><span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="p">)=&gt;</span><span class="nx">e</span><span class="p">.</span><span class="nx">innerHTML</span><span class="o">=</span><span class="nx">n</span><span class="p">),</span><span class="nx">h</span><span class="o">=</span><span class="p">((</span><span class="nx">e</span><span class="p">,</span><span class="nx">n</span><span class="p">)=&gt;</span><span class="nx">H</span><span class="p">(</span><span class="nx">D</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">e</span><span class="p">),</span><span class="nx">n</span><span class="p">)),</span><span class="nx">s</span><span class="o">=</span><span class="p">(()=&gt;{</span><span class="k">for</span><span class="p">(;</span><span class="nx">n</span><span class="o">&lt;</span><span class="nx">x</span><span class="p">.</span><span class="nx">currentTime</span><span class="o">+</span><span class="nx">l</span><span class="p">;)</span><span class="nx">o</span><span class="o">=</span><span class="nx">x</span><span class="p">.</span><span class="nx">createOscillator</span><span class="p">(),</span><span class="nx">v</span><span class="o">=</span><span class="nx">x</span><span class="p">.</span><span class="nx">createGain</span><span class="p">(),</span><span class="nx">o</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">v</span><span class="p">),</span><span class="nx">v</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">x</span><span class="p">.</span><span class="nx">destination</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">frequency</span><span class="p">.</span><span class="nx">value</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span><span class="nx">o</span><span class="p">.</span><span class="nx">start</span><span class="p">(</span><span class="nx">n</span><span class="p">),</span><span class="nx">o</span><span class="p">.</span><span class="nx">stop</span><span class="p">(</span><span class="nx">n</span><span class="o">+</span><span class="mf">.1</span><span class="p">),</span><span class="nx">G</span><span class="o">=</span><span class="nx">v</span><span class="p">.</span><span class="nx">gain</span><span class="p">,</span><span class="nx">G</span><span class="p">.</span><span class="nx">setValueAtTime</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="nx">G</span><span class="p">.</span><span class="nx">exponentialRampToValueAtTime</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nx">n</span><span class="p">,</span><span class="nx">n</span><span class="o">+</span><span class="mf">.05</span><span class="p">),</span><span class="nx">G</span><span class="p">.</span><span class="nx">linearRampToValueAtTime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">n</span><span class="o">+</span><span class="mf">.1</span><span class="p">),</span><span class="nx">n</span><span class="o">+=</span><span class="mi">60</span><span class="o">/</span><span class="nx">b</span><span class="p">}),</span><span class="nx">r</span><span class="o">=</span><span class="p">(()=&gt;</span><span class="nx">p</span><span class="o">&amp;&amp;</span><span class="p">(</span><span class="nx">s</span><span class="p">(),</span><span class="nx">setTimeout</span><span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">i</span><span class="p">))),</span><span class="nx">c</span><span class="o">=</span><span class="p">(()=&gt;{</span><span class="nx">p</span><span class="o">=!</span><span class="nx">p</span><span class="p">,</span><span class="nx">p</span><span class="o">?</span><span class="p">(</span><span class="nx">h</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;stop&quot;</span><span class="p">),</span><span class="nx">n</span><span class="o">=</span><span class="nx">x</span><span class="p">.</span><span class="nx">currentTime</span><span class="p">,</span><span class="nx">r</span><span class="p">())</span><span class="o">:</span><span class="nx">h</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;play&quot;</span><span class="p">)}),</span><span class="nx">a</span><span class="o">=</span><span class="p">(</span><span class="nx">e</span><span class="p">=&gt;</span><span class="nx">h</span><span class="p">(</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="nx">b</span><span class="o">=</span><span class="nx">M</span><span class="p">.</span><span class="nx">min</span><span class="p">(</span><span class="nx">M</span><span class="p">.</span><span class="nx">max</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="nx">b</span><span class="o">+</span><span class="nx">e</span><span class="p">),</span><span class="mi">240</span><span class="p">))),</span><span class="nb">window</span><span class="p">.</span><span class="nx">onload</span><span class="o">=</span><span class="p">(()=&gt;[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span><span class="mi">25</span><span class="p">].</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">n</span><span class="p">=&gt;(</span><span class="nx">e</span><span class="o">=</span><span class="nx">D</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s2">&quot;button&quot;</span><span class="p">),</span><span class="nx">e</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,()=&gt;</span><span class="nx">a</span><span class="p">(</span><span class="nx">n</span><span class="p">)),</span><span class="nx">H</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="o">+</span><span class="nx">n</span><span class="p">),</span><span class="nx">D</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">e</span><span class="p">))));&lt;/</span><span class="nt">script</span><span class="p">&gt;&lt;</span><span class="nt">p</span> <span class="na">id</span><span class="o">=</span><span class="s">b</span><span class="p">&gt;</span>100<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;&lt;</span><span class="nt">button</span> <span class="na">id</span><span class="o">=</span><span class="s">c</span> <span class="na">onclick</span><span class="o">=</span><span class="s">c();</span><span class="p">&gt;</span>play<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</pre></div>


<p>Golfing: https://dev.to/emnudge/js-code-golfing-how-to-ruin-everyone-s-day-40h3</p>
<p>Minifier: https://javascript-minifier.com/</p>
<h3>Comparison</h3>
<p>5.18MB, 11.35MB, 546.96KB, 374.94KB, 591.47KB, 217.56KB, 3.87MB</p>
<hr>
<p><i>Post Date: 2020-05-01</i></p>
<p>For more, <a href="https://twitter.com/KevinGalligan2">follow me on Twitter</a> or subscribe to the <a href="/feed.xml">RSS feed</a>.</p>
<a href="/blog.html">Back to blog</a>

</body>
</html>